<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dam.jsoup.updatereport.updatreport.dao.GoodsMapper">

    <select id="getMaList" resultType="dam.jsoup.updatereport.updatreport.vo.GoodList" parameterType="dam.jsoup.updatereport.updatreport.vo.SearchGoodsVo">
          select ma.ma_name goodName,
                 ma.ma_tip des,
                 '1'  type,
                 ma.ma_rate rate,
                 ma.ma_sale_num saleNum,
                 ma.create_time sendTime,
                 ma.tips tips,
                 ma.user_id ownerId,
                 ma.ma_id  id,
                 jud.user_nick_name createUser,
                 oa.ma_id have
          from jsoup_mission_all ma
                   left join jsoup_user_detail jud
                             on ma.user_id = jud.user_id
                   left join order_jsoup_ma oa
                             on oa.ma_id = ma.ma_id
          where
          <if test="tip != null and tip != ''">
              tips like concat('%',#{tip,jdbcType=VARCHAR},'%') and
          </if>
          <if test="name != null and tip != ''">
            goodName like concat('%',#{name,jdbcType=VARCHAR},'%') and
          </if>
          <if test="id != null">
            id = #{id} and
          </if>
        <if test="userId != null">
            ownerId =#{userId} and
        </if>
        <if test="leftDate != null">
            sendTime  &gt;  #{leftDate,jdbcType=TIMESTAMP} and
        </if>
        <if test="rightDate != null">
            sendTime &lt;  #{rightDate,jdbcType=TIMESTAMP} and
        </if>
                1 = 1
                order by
        <if test="sortByDownload == 1">
            saleNum,
        </if>
        <if test="sortByRate == 1">
            rate ,
        </if>
        sendTime DESC
        LIMIT #{pageStart},#{pageEnd}
    </select>
    <select id="getMhList" resultType="dam.jsoup.updatereport.updatreport.vo.GoodList" parameterType="dam.jsoup.updatereport.updatreport.vo.SearchGoodsVo">
        select ma.mission_all_name goodName,
        ma.mission_all_dis des,
        '2'  type,
        ma.sale_rate rate,
        ma.sale_num saleNum,
        ma.sent_time sendTime,
        ma.tips tips,
        ma.user_id ownerId,
        ma.mission_all_history_id  id,
        jud.user_nick_name createUser,
        oa.ma_id have
        from jsoup_mission_all_history ma
        left join jsoup_user_detail jud
        on ma.user_id = jud.user_id
        left join order_jsoup_mh oa
        on oa.mh_id = ma.mission_all_history_id
        where
        <if test="tip != null and tip != ''">
            tips like concat('%',#{tip,jdbcType=VARCHAR},'%') and
        </if>
        <if test="name != null and tip != ''">
            goodName like concat('%',#{name,jdbcType=VARCHAR},'%') and
        </if>
        <if test="id != null">
            id = #{id} and
        </if>
        <if test="userId != null">
            ownerId =#{userId} and
        </if>
        <if test="leftDate != null">
            sendTime  &gt;  #{leftDate,jdbcType=TIMESTAMP} and
        </if>
        <if test="rightDate != null">
            sendTime &lt;  #{rightDate,jdbcType=TIMESTAMP} and
        </if>
        1 = 1
        order by
        <if test="sortByDownload == 1">
            saleNum,
        </if>
        <if test="sortByRate == 1">
            rate ,
        </if>
        sendTime DESC
        LIMIT #{pageStart},#{pageEnd}
    </select>
</mapper>